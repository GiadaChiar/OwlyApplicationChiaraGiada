/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./src/search.js"
/*!***********************!*\
  !*** ./src/search.js ***!
  \***********************/
() {

eval("{\r\n\r\n//import './style/search.scss';\r\n\r\n\r\n\r\n/*creo due costanti per le due classi*/\r\nconst hamMenu = document.querySelector('.ham-menu');\r\nconst offScreenMenu = document.querySelector('.off-screen-menu');\r\nconst elencMenu= document.querySelectorAll('.off-screen-menu h3 a')//qualsiasi all\r\nconst menu_filters= document.getElementById(\"more-filters\");\r\n//const delete_html_filter= document.getElementById(\"delete_html_filter\");\r\nconst button_filters = document.getElementById(\"filters\");\r\n\r\nlet selectedLanguage =\"en\";\r\n\r\n//default hide menu filters\r\nmenu_filters.style.display=\"none\";\r\n\r\n\r\n\r\nasync function testTranslate() {\r\n    const bodyToSend = {\r\n        text: \"Questa è la mia vita,davvero meravigliosa\",\r\n        target: \"en\"\r\n    };\r\n\r\n    const response = await fetch(\"http://localhost:3000/translate\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(bodyToSend)\r\n    });\r\n\r\n    const data = await response.json();\r\n    console.log(\"Tradotto:\", data.translatedText);\r\n}\r\n\r\ntestTranslate();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nhamMenu.addEventListener('click', () => {\r\n    hamMenu.classList.toggle('active');  // attivo/disattivo la X\r\n    offScreenMenu.classList.toggle('active'); // mostro/nascondo il menu\r\n    \r\n    // Blocca lo scroll quando il menu è aperto\r\n    document.body.classList.toggle('no-scroll');\r\n})\r\n\r\n//su qualsiasi elemento che clicchi \r\nelencMenu.forEach(link => {\r\n    link.addEventListener('click', ()=>{\r\n        offScreenMenu.classList.toggle('active');//nascondo menu\r\n        hamMenu.classList.toggle('active');  // attivo/disattivo la X\r\n        document.body.classList.toggle('no-scroll');//se era bloccato lo riattiva\r\n\r\n    });\r\n});\r\n\r\n//take input category value \r\nconst searchButton = document.getElementById('cerca');\r\nconst categoryInput = document.getElementById('category');\r\nconst risultatiDiv = document.getElementById('risultati');\r\nrisultatiDiv.style.display=\"none\";\r\n\r\n\r\n//I whant to check if textbox category isn't empty \r\ncategoryInput.addEventListener(\"input\", () => {\r\n    const category = categoryInput.value.trim();\r\n    if (category !== \"\") {\r\n        searchButton.style.color = \"white\";\r\n    } else {\r\n        searchButton.style.color = \"grey\";\r\n}\r\n});\r\n\r\n\r\n\r\n//function to create a section with div and description-----------------------------------------------------------------------------------\r\nfunction ViewSearch(data,selectedLanguage){\r\n\r\n    risultatiDiv.innerHTML = \"\"; // pulisce risultati precedenti\r\n    if(data.numFound==0){\r\n        risultatiDiv.innerHTML = \"\"; // pulisce risultati precedenti\r\n        alert(\"No books were found! Try a different search.\")\r\n\r\n\r\n    }else{\r\n\r\n\r\n        data.docs.forEach(doc => {\r\n            const rowDiv = document.createElement('div');\r\n            rowDiv.classList.add('book-row');\r\n            rowDiv.id = doc.key; \r\n            // rimuove /works/ dal key per avere un ID valido\r\n\r\n            const inerrRowDiv = document.createElement('div');\r\n            inerrRowDiv.classList.add('inner-row');\r\n            rowDiv.appendChild(inerrRowDiv);\r\n\r\n            const titleElement = document.createElement('a');\r\n            titleElement.textContent = doc.title ?? \"Title not available\";\r\n            titleElement.id = doc.key;\r\n            titleElement.classList.add('book-title', 'btn', 'btn-primary');\r\n            titleElement.setAttribute('data-bs-toggle', 'collapse');\r\n            titleElement.setAttribute('href', '#collapseExample');\r\n            titleElement.setAttribute('role', 'button');\r\n            titleElement.setAttribute('aria-expanded', 'false');\r\n            titleElement.setAttribute('aria-controls', 'collapseExample');\r\n\r\n        /*   <a class=\"btn btn-primary\" data-bs-toggle=\"collapse\" href=\"#collapseExample\" role=\"button\" aria-expanded=\"false\" aria-controls=\"collapseExample\">\r\n    Link with href\r\n    </a>*/\r\n\r\n            const authorElement = document.createElement('h3');\r\n            authorElement.textContent = doc.author_name ? doc.author_name.join(\", \") : \"Autore sconosciuto\";\r\n            authorElement.classList.add('book-author');\r\n            authorElement.id = doc.key;\r\n            \r\n\r\n            risultatiDiv.style.display=\"block\";\r\n            inerrRowDiv.appendChild(authorElement);\r\n            inerrRowDiv.appendChild(titleElement);\r\n            rowDiv.appendChild(inerrRowDiv);\r\n\r\n            risultatiDiv.appendChild(rowDiv);\r\n\r\n        });\r\n        //create button for delete \r\n            const deleteBt=document.createElement(\"button\");\r\n                deleteBt.id = \"delete_bt\";\r\n                deleteBt.type = \"button\";\r\n                deleteBt.classList.add(\"btn-close\");\r\n                deleteBt.setAttribute(\"aria-label\", \"Close\");\r\n                risultatiDiv.appendChild(deleteBt);\r\n\r\n            deleteBt.addEventListener(\"click\",()=>{\r\n                risultatiDiv.style.display=\"none\";\r\n                risultatiDiv.innerHTML = \"\";\r\n            })\r\n\r\n        //create icone info to information about book\r\n            const infoIcon = document.createElement('i');\r\n            infoIcon.classList.add('bi', 'bi-info-circle-fill');\r\n            infoIcon.id = \"info_icon\";\r\n            risultatiDiv.appendChild(infoIcon);\r\n\r\n        //if I pass over the icon show alert with information\r\n            infoIcon.addEventListener(\"mouseover\", () => {\r\n                infobox =document.createElement(\"div\");\r\n                infobox.id=\"info_box\";\r\n                infobox.textContent = \"List of books with authors and titles based on the selected category.\";\r\n            risultatiDiv.appendChild(infobox);\r\n            });\r\n\r\n            //if I exit from icon the infobox disappear\r\n            infoIcon.addEventListener(\"mouseleave\",()=>{\r\n                infobox.remove();\r\n            })\r\n\r\n            //if I click I pass hover mouse  get other informations info\r\n            bookTitles= document.querySelectorAll(\".book-title\")\r\n    \r\n\r\n        bookTitles.forEach(title => {\r\n        title.addEventListener(\"click\", async() => {\r\n            \r\n            const row = title.closest(\".book-row\");\r\n            //call another API \r\n            //donm't usen encodeURIComponent bacause it trasform / in %\r\n            const url =`https://openlibrary.org${title.id}.json`;\r\n            console.log(\"Url richiesta desc:\", url)\r\n            console.log(\"stampo id:\", title.id)\r\n\r\n\r\n            /* try {\r\n        const response = await fetch(url);\r\n        if (!response.ok) throw new Error(\"Errore API \" + response.status);\r\n\r\n        const data = await response.json();\r\n        console.log(\"Risultati API:\", data.docs);*/\r\n\r\n        try{\r\n            const response = await fetch(url);\r\n            if(!response.ok) throw new Error(\"Error loading description\")\r\n            const data = await response.json();\r\n            console.log(\"Risultati descrizione API:\",data.description)\r\n\r\n\r\n\r\n            if (!row) return;\r\n\r\n            // controlla se c'è già una descrizione sotto questa riga\r\n            if (row.nextElementSibling?.classList.contains(\"description-box\")) {\r\n                return; // evita duplicati\r\n            }\r\n\r\n            //check data if it is an object or a string or it is empty\r\n            /* let descriptionText = \"Descrizione non disponibile\";\r\n\r\n            if (typeof data.description === \"string\") {\r\n                descriptionText = data.description;\r\n            } else if (\r\n                typeof data.description === \"object\" &&\r\n                data.description?.value\r\n            ) {\r\n                if(selectedLanguage !==\"en\"){\r\n                    descriptionText = await translateText(data.description.value, selectedLanguage);\r\n                    console.log(\"Descrizione tradotta:\", descriptionText); // ora\r\n                }else{\r\n                    descriptionText = data.description.value;\r\n                }\r\n            }\r\n                */\r\n            let descriptionText = \"Description not available\";\r\n\r\n        if (data.description) {\r\n            // ottieni il testo reale, sia che sia stringa o oggetto\r\n            let rawText = (typeof data.description === \"string\") \r\n                ? data.description \r\n                : (typeof data.description === \"object\" && data.description.value) \r\n                    ? data.description.value \r\n                    : \"Description not available\";\r\n\r\n            // traduci solo se lingua diversa da inglese\r\n            if (selectedLanguage !== \"en\") {\r\n                descriptionText = await translateText(rawText, selectedLanguage);\r\n                console.log(\"Descrizione tradotta:\", descriptionText);\r\n            } else {\r\n                descriptionText = rawText;\r\n            }\r\n\r\n        }\r\n\r\n\r\n\r\n            // crea il div descrizione\r\n            const divPlace = document.createElement(\"div\");\r\n            divPlace.classList.add(\"description-box\");\r\n            const titleDesc= document.createElement(\"h5\")\r\n            titleDesc.classList.add(\"desc_title\")\r\n            titleDesc.textContent=\" Description:\"\r\n\r\n            const pDesc= document.createElement(\"p\");\r\n            pDesc.classList.add(\"desc_p\");\r\n            pDesc.textContent = descriptionText;\r\n            \r\n            divPlace.appendChild(titleDesc)\r\n            divPlace.appendChild(pDesc);\r\n            \r\n            // inserisce subito sotto la riga del libro\r\n            row.after(divPlace);\r\n\r\n             //create button for delete \r\n            const deleteBt=document.createElement(\"button\");\r\n                deleteBt.id = \"delete_bt-des\";\r\n                deleteBt.type = \"button\";\r\n                deleteBt.classList.add(\"btn-close\");\r\n                deleteBt.setAttribute(\"aria-label\", \"Close\");\r\n                divPlace.appendChild(deleteBt);\r\n\r\n            deleteBt.addEventListener(\"click\",()=>{\r\n                \r\n                divPlace.remove();\r\n                deleteBt.remove();\r\n            })\r\n        \r\n\r\n        }catch(error){\r\n            console.log(\"Errore caricamento descrizione\")\r\n        }\r\n        \r\n            \r\n        });\r\n    });\r\n\r\n\r\n}}\r\n\r\n\r\n\r\n//--------------------end function-----------------------------------------------------\r\n\r\n\r\n//if I click on search button\r\n\r\n\r\nsearchButton.addEventListener(\"click\", async () => {\r\n    const category = categoryInput.value.trim();\r\n    if (!category){\r\n        alert(\"Please enter a valid category.\");\r\n        return;\r\n    };\r\n\r\n    const url = `https://openlibrary.org/search.json?subject=${encodeURIComponent(category)}` +\"&limit=20\";\r\n    console.log(\"URL richiesta:\", url); \r\n\r\n    try {\r\n        const response = await fetch(url);\r\n        if (!response.ok) throw new Error(\"Errore API \" + response.status);\r\n\r\n        const data = await response.json();\r\n        console.log(\"Risultati API:\", data.docs); // <-- QUI\r\n\r\n        if(selectedLanguage===\"en\"){\r\n            console.log(\"selectedLanguage:\",selectedLanguage)\r\n            ViewSearch(data);\r\n        }\r\n        else{\r\n            console.log(\"lingua selezionata differente\")\r\n        }\r\n        \r\n        \r\n            \r\n    } catch (error) {\r\n        console.error(\"Errore durante il recupero dei dati:\", error);\r\n    }\r\n\r\n\r\n});\r\n\r\n\r\nconst delete_html_filter= document.getElementById(\"delete_html_filter\");\r\n\r\n//if I click on more filters show menu filter\r\nbutton_filters.addEventListener(\"click\",()=>{\r\n    menu_filters.style.display=\"block\";\r\n})\r\n\r\n//add x to close menu filter (part in html)\r\n\r\ndelete_html_filter.addEventListener(\"click\",async()=>{\r\n    menu_filters.style.display=\"none\";\r\n});\r\n\r\n\r\n\r\n\r\n///function to get traslate \r\n\r\n\r\n\r\n\r\n//how to get language selected\r\n\r\nconst languageItems = document.querySelectorAll(\".dropdown-item\");\r\n\r\nlanguageItems.forEach(item => {\r\n    item.addEventListener(\"click\", e => {\r\n        e.preventDefault();\r\n        selectedLanguage = item.dataset.lang;\r\n        console.log(\"Lingua selezionata:\", selectedLanguage);\r\n    });\r\n});\r\n\r\n\r\n\r\n//function to traslate\r\n\r\n/*\r\nasync function translateText(text, targetLang) {\r\n    // Se lingua inglese o testo vuoto → non tradurre\r\n    if (!text || targetLang === \"en\") {\r\n        return text;\r\n    }\r\n\r\n    try {\r\n        const response = await fetch(\"https://libretranslate.de/translate\", {\r\n            method: \"POST\",\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                q: text,\r\n                source: \"auto\",\r\n                target: targetLang,\r\n                format: \"text\"\r\n            })\r\n        });\r\n\r\n        const data = await response.json();\r\n        console.log(\"testo tradotto:\",data.translatedText);\r\n        return data.translatedText;\r\n        \r\n\r\n    } catch (error) {\r\n        console.error(\"Errore traduzione:\", error);\r\n        return text; // fallback\r\n    }\r\n}\r\n*/\r\n\r\nasync function translateText(text, targetLang) {\r\n    if (!text || targetLang === \"en\") return text;\r\n\r\n    try {\r\n        const response = await fetch(\"http://localhost:3000/translate\", {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json\" },\r\n            body: JSON.stringify({ text, target: targetLang })\r\n        });\r\n\r\n        const data = await response.json();\r\n        console.log(\"testo tradotto:\", data.translatedText);\r\n        return data.translatedText;\r\n\r\n    } catch (error) {\r\n        console.error(\"Errore traduzione:\", error);\r\n        return text;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n/*search with author and title and language if there is also category,\r\neverything will be work also if there insn't one or more selections.*/\r\n//language selection:\r\n    \r\n/*first step get category and all the other choosen*/\r\n//const categoryInput = document.getElementById('category'); get value\r\nconst searchButtonFilter= document.getElementById(\"search_filter\")\r\nsearchButtonFilter.addEventListener(\"click\",async()=>{\r\n    const authorInput= document.getElementById(\"author\");\r\n    const titleInput = document.getElementById(\"title\");\r\n\r\n\r\n   \r\n    \r\n    //late language but l have to add it \r\n   /* if(authorInput.value) {\r\n        console.log(authorInput.value);\r\n    }else {\r\n        console.log(\"autore non selezionato\")\r\n    }*/\r\n   //same \r\n    console.log(authorInput.value ? authorInput.value : \"autore non selezionato\");\r\n    console.log(titleInput.value ? titleInput.value: \"titolo non selezionato\");\r\n    console.log (categoryInput.value ? categoryInput.value : \"categoria non selezionata\");\r\n    //console.log(languageSelecte.value ? languageSelecte.value : \"linguaggio non selezionato\");\r\n    console.log(\"Lingua usata nella ricerca:\", selectedLanguage);\r\n   \r\n//author_name\r\n   //language\r\n   //title\r\n\r\n   //fetch more filters\r\n   /* const url = `https://openlibrary.org/search.json?subject=${categoryInput.value}&author_name=${encodeURIComponent(authorInput.value)}`+\"&limit=20\";\r\n\r\n    if(categoryInput.value){\r\n        const catUrl= + `subject=${categoryInput.value}`\r\n    } \r\n\r\n    if(authorInput.value){\r\n        const authUrl= + `author_name=${encodeURIComponent(authorInput.value)}`\r\n        if(categoryInput.value){\r\n            const authorInput = + `&author_name=${encodeURIComponent(authorInput.value)}`\r\n        }\r\n    }\r\n    \r\n    console.log(\"URL richiesta:\", url); */\r\n\r\n    const baseUrl= `https://openlibrary.org/search.json`\r\n    \r\n    //object for create dynamic url, fantastic!\r\n    const params = new URLSearchParams();\r\n\r\n    //category\r\n    if (categoryInput.value) {\r\n    params.append(\"subject\", categoryInput.value);\r\n    }\r\n\r\n    //author\r\n    if(authorInput.value){\r\n        params.append(\"author_name\",authorInput.value);\r\n    }\r\n\r\n    //title\r\n    if(titleInput.value){\r\n        params.append(\"title\",titleInput.value);\r\n    }\r\n    //limit \r\n    params.append(\"limit\", \"5\");\r\n\r\n    const url = `${baseUrl}?${params.toString()}`;\r\n    console.log(url);\r\n\r\n    try{\r\n        response = await fetch(url);\r\n        if(!response.ok) throw new Error(\"Errore caricamento descrizione\")\r\n            const data = await response.json();\r\n        console.log(data);\r\n\r\n//----------------------------------------da qui------------------------------------------------------------------\r\n        ViewSearch(data,selectedLanguage);\r\n\r\n        \r\n//----------------------------------------------------------a qui------------\r\n        ///create a fun ction to do that and recall it\r\n\r\n\r\n    }catch(error){\r\n        console.log(\"Errore fetch dei filtri aggiuntivi\")\r\n    }\r\n\r\n\r\n})\n\n//# sourceURL=webpack://owlyapplicationchiaragiada/./src/search.js?\n}");

/***/ }

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./src/search.js"]();
/******/ 	
/******/ })()
;